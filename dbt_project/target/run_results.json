{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.14", "generated_at": "2025-11-02T17:37:25.558224Z", "invocation_id": "1089a288-9e3a-4812-add1-1ba90be3d489", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-02T17:37:20.900642Z", "completed_at": "2025-11-02T17:37:20.909675Z"}, {"name": "execute", "started_at": "2025-11-02T17:37:20.945973Z", "completed_at": "2025-11-02T17:37:21.614020Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.7300355434417725, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.tourism_weather.stg_tourism", "compiled": true, "compiled_code": "with src as (select * from \"tereza_tourist\".\"core\".\"tourism_monthly_clean\")\nselect\n  month_start,\n  region,\n  tourists_total,\n  year,\n  month\nfrom src", "relation_name": "\"tereza_tourist\".\"core\".\"stg_tourism\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-02T17:37:20.896123Z", "completed_at": "2025-11-02T17:37:20.908403Z"}, {"name": "execute", "started_at": "2025-11-02T17:37:20.910906Z", "completed_at": "2025-11-02T17:37:21.616510Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7317557334899902, "adapter_response": {"_message": "SELECT 6", "code": "SELECT", "rows_affected": 6}, "message": "SELECT 6", "failures": null, "unique_id": "model.tourism_weather.dim_weather_bins", "compiled": true, "compiled_code": "\n\n-- dbt-\u043c\u043e\u0434\u0435\u043b\u044c, \u044f\u043a\u0430 \u0432\u0456\u0434\u0434\u0430\u0454 \u0440\u0456\u0432\u043d\u043e \u0442\u0456 \u043a\u043e\u043b\u043e\u043d\u043a\u0438, \u044f\u043a\u0456 \u043e\u0447\u0456\u043a\u0443\u044e\u0442\u044c \u0442\u0435\u0441\u0442\u0438\nselect\n    bin_name,\n    t_min,\n    t_max\nfrom marts.dim_weather_bins", "relation_name": "\"tereza_tourist\".\"marts\".\"dim_weather_bins\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-02T17:37:20.902674Z", "completed_at": "2025-11-02T17:37:20.908831Z"}, {"name": "execute", "started_at": "2025-11-02T17:37:20.934831Z", "completed_at": "2025-11-02T17:37:21.618454Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.7307853698730469, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.tourism_weather.stg_weather", "compiled": true, "compiled_code": "with src as (select * from \"tereza_tourist\".\"core\".\"weather_daily_clean\")\nselect\n  dt,\n  month_start,\n  avg_temp_c,\n  min_temp_c,\n  max_temp_c,\n  humidity_avg,\n  wind_speed_avg_ms,\n  precipitation_mm,\n  temp_bucket\nfrom src", "relation_name": "\"tereza_tourist\".\"core\".\"stg_weather\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-02T17:37:21.643399Z", "completed_at": "2025-11-02T17:37:21.686217Z"}, {"name": "execute", "started_at": "2025-11-02T17:37:21.707544Z", "completed_at": "2025-11-02T17:37:22.202159Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6123347282409668, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.tourism_weather.not_null_dim_weather_bins_bin_name.9b5ace16e4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect bin_name\nfrom \"tereza_tourist\".\"marts\".\"dim_weather_bins\"\nwhere bin_name is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-02T17:37:21.655925Z", "completed_at": "2025-11-02T17:37:21.690860Z"}, {"name": "execute", "started_at": "2025-11-02T17:37:21.737744Z", "completed_at": "2025-11-02T17:37:22.209661Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6177268028259277, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.tourism_weather.unique_dim_weather_bins_bin_name.d6cc898897", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    bin_name as unique_field,\n    count(*) as n_records\n\nfrom \"tereza_tourist\".\"marts\".\"dim_weather_bins\"\nwhere bin_name is not null\ngroup by bin_name\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-02T17:37:21.640969Z", "completed_at": "2025-11-02T17:37:21.688861Z"}, {"name": "execute", "started_at": "2025-11-02T17:37:21.730106Z", "completed_at": "2025-11-02T17:37:22.372212Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.744035005569458, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.tourism_weather.int_tourism", "compiled": true, "compiled_code": "select * from \"tereza_tourist\".\"core\".\"stg_tourism\"", "relation_name": "\"tereza_tourist\".\"core\".\"int_tourism\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-02T17:37:21.662750Z", "completed_at": "2025-11-02T17:37:21.695378Z"}, {"name": "execute", "started_at": "2025-11-02T17:37:21.748471Z", "completed_at": "2025-11-02T17:37:22.375026Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.7424173355102539, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.tourism_weather.int_weather_monthly", "compiled": true, "compiled_code": "with w as (select * from \"tereza_tourist\".\"core\".\"stg_weather\")\nselect\n  date_trunc('month', month_start)::date as month_start,\n  avg(avg_temp_c) as avg_temp_c,\n  avg(humidity_avg) as humidity_avg,\n  avg(wind_speed_avg_ms) as wind_speed_avg_ms,\n  sum(precipitation_mm) as precipitation_mm_sum\nfrom w\ngroup by 1", "relation_name": "\"tereza_tourist\".\"core\".\"int_weather_monthly\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-02T17:37:22.388512Z", "completed_at": "2025-11-02T17:37:22.395735Z"}, {"name": "execute", "started_at": "2025-11-02T17:37:22.397269Z", "completed_at": "2025-11-02T17:37:23.042878Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6588315963745117, "adapter_response": {"_message": "SELECT 70", "code": "SELECT", "rows_affected": 70}, "message": "SELECT 70", "failures": null, "unique_id": "model.tourism_weather.fact_tourism_weather", "compiled": true, "compiled_code": "\nwith t as (select * from \"tereza_tourist\".\"core\".\"int_tourism\"),\n     w as (select * from \"tereza_tourist\".\"core\".\"int_weather_monthly\")\nselect\n  t.month_start,\n  t.region,\n  t.tourists_total,\n  w.avg_temp_c,\n  w.humidity_avg,\n  w.wind_speed_avg_ms,\n  w.precipitation_mm_sum\nfrom t left join w using(month_start)", "relation_name": "\"tereza_tourist\".\"marts\".\"fact_tourism_weather\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-02T17:37:23.059235Z", "completed_at": "2025-11-02T17:37:23.067026Z"}, {"name": "execute", "started_at": "2025-11-02T17:37:23.071800Z", "completed_at": "2025-11-02T17:37:23.475014Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.46586108207702637, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.tourism_weather.not_null_fact_tourism_weather_region.3555eea461", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect region\nfrom \"tereza_tourist\".\"marts\".\"fact_tourism_weather\"\nwhere region is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-02T17:37:23.056099Z", "completed_at": "2025-11-02T17:37:23.066033Z"}, {"name": "execute", "started_at": "2025-11-02T17:37:23.067709Z", "completed_at": "2025-11-02T17:37:23.473526Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.46898770332336426, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.tourism_weather.not_null_fact_tourism_weather_month_start.ca39055e36", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month_start\nfrom \"tereza_tourist\".\"marts\".\"fact_tourism_weather\"\nwhere month_start is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-02T17:37:23.535434Z", "completed_at": "2025-11-02T17:37:23.542470Z"}, {"name": "execute", "started_at": "2025-11-02T17:37:23.547592Z", "completed_at": "2025-11-02T17:37:24.177583Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6534125804901123, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": "SELECT 1", "failures": null, "unique_id": "model.tourism_weather.dim_region", "compiled": true, "compiled_code": "\nselect distinct region\nfrom \"tereza_tourist\".\"marts\".\"fact_tourism_weather\"", "relation_name": "\"tereza_tourist\".\"marts\".\"dim_region\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-02T17:37:23.533159Z", "completed_at": "2025-11-02T17:37:23.541881Z"}, {"name": "execute", "started_at": "2025-11-02T17:37:23.544540Z", "completed_at": "2025-11-02T17:37:24.180044Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6557648181915283, "adapter_response": {"_message": "SELECT 70", "code": "SELECT", "rows_affected": 70}, "message": "SELECT 70", "failures": null, "unique_id": "model.tourism_weather.dim_date", "compiled": true, "compiled_code": "\n\nwith bounds as (\n  select\n    date_trunc('month', min(month_start)) as dmin,\n    date_trunc('month', max(month_start)) as dmax\n  from \"tereza_tourist\".\"marts\".\"fact_tourism_weather\"\n),\nmonths as (\n  select generate_series(dmin, dmax, interval '1 month')::date as m\n  from bounds\n)\nselect\n  m                                         as month_start,\n  extract(year  from m)::int                as year,\n  to_char(m, 'TMMonth')                     as month_name,\n  extract(month from m)::int                as month_num,\n  case\n    when extract(month from m) in (12,1,2) then 'winter'\n    when extract(month from m) in (3,4,5)  then 'spring'\n    when extract(month from m) in (6,7,8)  then 'summer'\n    else 'autumn'\n  end                                       as season\nfrom months", "relation_name": "\"tereza_tourist\".\"marts\".\"dim_date\""}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-02T17:37:24.215872Z", "completed_at": "2025-11-02T17:37:24.228224Z"}, {"name": "execute", "started_at": "2025-11-02T17:37:24.233553Z", "completed_at": "2025-11-02T17:37:24.641517Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.49336934089660645, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.tourism_weather.not_null_dim_date_month_start.218538c0fc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month_start\nfrom \"tereza_tourist\".\"marts\".\"dim_date\"\nwhere month_start is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-02T17:37:24.201697Z", "completed_at": "2025-11-02T17:37:24.231905Z"}, {"name": "execute", "started_at": "2025-11-02T17:37:24.244114Z", "completed_at": "2025-11-02T17:37:24.637942Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.4994680881500244, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.tourism_weather.not_null_dim_region_region.c4861442ef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect region\nfrom \"tereza_tourist\".\"marts\".\"dim_region\"\nwhere region is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-02T17:37:24.205570Z", "completed_at": "2025-11-02T17:37:24.228744Z"}, {"name": "execute", "started_at": "2025-11-02T17:37:24.235750Z", "completed_at": "2025-11-02T17:37:24.646600Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.49956750869750977, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.tourism_weather.relationships_fact_tourism_weather_region__region__ref_dim_region_.a0ad40aa60", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select region as from_field\n    from \"tereza_tourist\".\"marts\".\"fact_tourism_weather\"\n    where region is not null\n),\n\nparent as (\n    select region as to_field\n    from \"tereza_tourist\".\"marts\".\"dim_region\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-02T17:37:24.212074Z", "completed_at": "2025-11-02T17:37:24.229710Z"}, {"name": "execute", "started_at": "2025-11-02T17:37:24.239874Z", "completed_at": "2025-11-02T17:37:24.648220Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5020875930786133, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.tourism_weather.unique_dim_region_region.4179ee724e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    region as unique_field,\n    count(*) as n_records\n\nfrom \"tereza_tourist\".\"marts\".\"dim_region\"\nwhere region is not null\ngroup by region\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-02T17:37:24.714863Z", "completed_at": "2025-11-02T17:37:24.720579Z"}, {"name": "execute", "started_at": "2025-11-02T17:37:24.722382Z", "completed_at": "2025-11-02T17:37:25.114804Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.45543909072875977, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.tourism_weather.unique_dim_date_month_start.a9c160f67f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    month_start as unique_field,\n    count(*) as n_records\n\nfrom \"tereza_tourist\".\"marts\".\"dim_date\"\nwhere month_start is not null\ngroup by month_start\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-11-02T17:37:24.710583Z", "completed_at": "2025-11-02T17:37:24.723685Z"}, {"name": "execute", "started_at": "2025-11-02T17:37:24.725391Z", "completed_at": "2025-11-02T17:37:25.117209Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.45793914794921875, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.tourism_weather.relationships_fact_tourism_weather_month_start__month_start__ref_dim_date_.59b6d444a9", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select month_start as from_field\n    from \"tereza_tourist\".\"marts\".\"fact_tourism_weather\"\n    where month_start is not null\n),\n\nparent as (\n    select month_start as to_field\n    from \"tereza_tourist\".\"marts\".\"dim_date\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}], "elapsed_time": 6.138715028762817, "args": {"invocation_command": "dbt build --project-dir . --profiles-dir . --target prod --fail-fast -x", "introspect": true, "cache_selected_only": false, "populate_cache": true, "log_file_max_bytes": 10485760, "project_dir": ".", "log_path": "logs", "send_anonymous_usage_stats": true, "log_level": "info", "print": true, "show_resource_report": false, "write_json": true, "use_colors_file": true, "version_check": true, "printer_width": 80, "enable_legacy_logger": false, "log_format": "default", "macro_debugging": false, "partial_parse": true, "profiles_dir": ".", "static_parser": true, "fail_fast": true, "resource_types": [], "log_format_file": "debug", "vars": {}, "use_colors": true, "defer": false, "log_level_file": "debug", "strict_mode": false, "require_explicit_package_overrides_for_builtin_materializations": false, "indirect_selection": "eager", "partial_parse_file_diff": true, "warn_error_options": {"include": [], "exclude": []}, "quiet": false, "target": "prod", "include_saved_query": false, "exclude": [], "select": [], "which": "build", "favor_state": false, "show": false}}